<h2 class="mb-4">Crear Campaña</h2>

<form (ngSubmit)="createCampaign()" #campaignForm="ngForm" class="p-4 border rounded bg-light">

<div class="mb-3">
  <label for="user_id" class="form-label">Usuario:</label>
  <select
    id="user_id"
    [(ngModel)]="campaign.user_id"
    name="user_id"
    required
    class="form-control"
  >
    <option value="">Seleccione un usuario</option>
    <option *ngFor="let user of users" [value]="user.id">
      {{ user.username }}
    </option>
  </select>
</div>

  <div class="mb-3">
    <label for="name" class="form-label">Nombre de Campaña:</label>
    <input
      type="text"
      id="name"
      [(ngModel)]="campaign.name"
      name="name"
      required
      class="form-control"
    />
  </div>

  <div class="mb-3">
    <label for="message_text" class="form-label">Mensaje:</label>
    <textarea
      id="message_text"
      [(ngModel)]="campaign.message_text"
      name="message_text"
      required
      class="form-control"
      rows="4"
    ></textarea>
  </div>


<div class="mb-4">
  <label for="phone_input" class="form-label fw-bold">Agregar Teléfonos:</label>

  <div class="row g-2 align-items-center mb-3">
    <div class="col-auto flex-grow-1">
      <input
        type="text"
        id="phone_input"
        [(ngModel)]="phoneInput"
        name="phone_input"
        class="form-control"
        placeholder="Ej: 123456789"
      />
    </div>
    <div class="col-auto">
      <button type="button" class="btn btn-success" (click)="addPhone()">
        <i class="bi bi-plus-circle me-1"></i> Agregar
      </button>
    </div>
  </div>

  <div *ngIf="phoneNumbers.length > 0" class="mt-3">
    <h6 class="mb-2">Teléfonos agregados:</h6>
    <ul class="list-group">
      <li
        *ngFor="let phone of phoneNumbers; let i = index"
        class="list-group-item d-flex justify-content-between align-items-center"
      >
        <div>
          <i class="bi bi-telephone-fill text-primary me-2"></i>
          {{ phone }}
        </div>
        <button type="button" class="btn btn-sm btn-outline-danger" (click)="removePhone(i)">
          <i class="bi bi-trash"></i>
        </button>
      </li>
    </ul>
  </div>
</div>

  <button
    type="submit"
    [disabled]="!campaignForm.form.valid"
    class="btn btn-primary"
  >
    Crear Campaña
  </button>
</form>

<p *ngIf="message" class="text-success mt-3">{{ message }}</p>
<p *ngIf="error" class="text-danger mt-3">{{ error }}</p>